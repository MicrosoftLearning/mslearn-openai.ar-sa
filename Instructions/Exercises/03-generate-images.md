---
lab:
  title: إنشاء صور باستخدام نموذج DALL-E
---

# إنشاء صور باستخدام نموذج DALL-E

تتضمن خدمة Azure OpenAI نموذج إنشاء صور يسمى DALL-E. يمكنك استخدام هذا النموذج لإرسال مطالبات اللغة الطبيعية التي تصف الصورة المطلوبة، وسينشئ النموذج صورة أصلية استنادًا إلى الوصف الذي تقدمه.

في هذا التمرين، ستستخدم نموذج DALL-E الإصدار 3 لإنشاء صور استنادًا إلى مطالبات اللغة الطبيعية.

سيستغرق هذا التمرين حوالي **25** دقيقة.

## توفير مورد Azure OpenAI

قبل أن تتمكن من استخدام Azure OpenAI لإنشاء الصور، يجب توفير مورد Azure OpenAI في اشتراك Azure الخاص بك. يجب أن يكون المورد في منطقة يتم فيها دعم نماذج DALL-E.

1. سجّل الدخول إلى **Azure portal** من `https://portal.azure.com`.
1. إنشاء مورد **Azure OpenAI** بالإعدادات التالية:
    - **اشتراك**: *حدد اشتراك Azure الذي جرت الموافقة عليه للوصول إلى خدمة Azure OpenAI، بما في ذلك DALL-E*
    - **مجموعة الموارد**: *اختيار مجموعة موارد أو إنشاءها*
    - **المنطقة**: *اختر إما **شرق الولايات المتحدة**، أو **شرق أستراليا**، أو **وسط السويد***\*
    - **الاسم**: *اسم فريد من اختيارك*
    - **مستوى التسعير**: قياسي S0

    > \*تتوفر نماذج DALL-E 3 فقط في موارد خدمة Azure OpenAI في مناطق **شرق الولايات المتحدة**، و**شرق أستراليا**، و**وسط السويد**.

1. يُرجى الانتظار لاكتمال التوزيع. ثم انتقل إلى مورد Azure OpenAI الموزّع في مدخل Microsoft Azure.

## توزيع النموذج

بعد ذلك، ستقوم بإنشاء نشر للنموذج **Dalle3** من خلال واجهة CLI. في بوابة Azure؛ حدد أيقونة **Cloud Shell** من شريط القوائم العلوي وتأكد من تعيين محطتك الطرفية على **Bash**. راجع هذا المثال واستبدل المتغيرات التالية بالقيم الخاصة بك:

```dotnetcli
az cognitiveservices account deployment create \
   -g *your resource group* \
   -n *your Open AI resource* \
   --deployment-name dall-e-3 \
   --model-name dall-e-3 \
   --model-version 3.0  \
   --model-format OpenAI \
   --sku-name "Standard" \
   --sku-capacity 1
```

    > \* Sku-capacity is measured in thousands of tokens per minute. A rate limit of 1,000 tokens per minute is more than adequate to complete this exercise while leaving capacity for other people using the same subscription.


## استخدام واجهة برمجة تطبيقات REST لإنشاء الصور

توفر خدمة Azure OpenAI واجهة برمجة تطبيقات REST التي يمكنك استخدامها لإرسال مطالبات لإنشاء المحتوى - بما في ذلك الصور التي تم إنشاؤها بواسطة نموذج DALL-E.

### الاستعداد لتطوير تطبيق في تعليمة Visual Studio البرمجية

الآن دعنا نستكشف كيفية إنشاء تطبيق مخصَّص يستخدم خدمة Azure OpenAI لإنشاء الصور. ستقوم بتطوير تطبيقك باستخدام تعليمة Visual Studio البرمجية. تم توفير ملفات التعليمات البرمجية لتطبيقك في مستودع GitHub.

> **تلميح**: إذا نسخت بالفعل مستودع **mslearn-openai**، فافتحه في تعليمة Visual Studio البرمجية. وإلا فاتبع هذه الخطوات لاستنساخه إلى بيئة تطويرك.

1. ابدأ تشغيل Visual Studio Code.
2. افتح لوحة (SHIFT+CTRL+P) وشغّل **Git: استنسخ الأمر ** لاستنساخ مستودع `https://github.com/MicrosoftLearning/mslearn-openai` إلى مجلد محلي (لا يُهم أي مجلد).
3. عند استنساخ المستودع، افتح المجلد في Visual Studio Code.

    > **ملاحظة**: إذا عرضت لك Visual Studio Code رسالة منبثقة لمطالبتك بالثقة في التعليمات البرمجية التي تفتحها، فانقر فوق **نعم، أثق في خيار الكُتاب** في النافذة المنبثقة.

4. انتظر حتى تثبيت ملفات إضافية لدعم مشاريع التعليمات البرمجية C# في المستودع.

    > **ملاحظة**: في حالة مطالبتك بإضافة الأصول المطلوبة للبناء وتصحيح الأخطاء، فحدد **ليس الآن**.

### تكوين تطبيقك

تم توفير تطبيقات لكل من C# وPython. يتميز كلا التطبيقين بالوظيفة نفسها. أولاً، ستضيف نقطة النهاية والمفتاح لمورد Azure OpenAI لديك إلى ملف تكوين التطبيق.

1. في Visual Studio Code، في جزء **المستكشف**، انتقل إلى المجلد **Labfiles/03-image-generation** ووسّع نطاق المجلد **CSharp** أو **Python** وفقًا لتفضيلات اللغة الخاصة بك. يحتوي كل مجلد على الملفات الخاصة باللغة للتطبيق الذي تريد دمج وظيفة Azure OpenAI فيه.
2. في جزء**مستكشف**، في مجلد **CSharp** أو **Python**، افتح ملف التكوين للغة المفضلة لديك

    - **C#**: appsettings.json
    - **Python**: .env
    
3. قم بتحديث قيم التكوين لتضمين **نقطة النهاية** و**مفتاح** من مورد Azure OpenAI الذي أنشأته (متوفر في صفحة **المفاتيح ونقطة النهاية** لمورد Azure OpenAI في مدخل Microsoft Azure).
4. احفظ ملف التكوين.

### عرض التعليمات البرمجية للتطبيق

أنت الآن جاهز لاستكشاف التعليمات البرمجية المستخدمة لاستدعاء واجهة برمجة تطبيقات REST وإنشاء صورة.

1. في جزء** Explorer**، حدد ملف التعليمات البرمجية الرئيسي للتطبيق لديك:

    - C#: `Program.cs`
    - Python: `generate-image.py`

2. راجع التعليمات البرمجية التي يحتوي عليها الملف، مع ملاحظة الميزات الرئيسية التالية:
    - تقدم التعليمات البرمجية طلب https إلى نقطة النهاية للخدمة الخاصة بك، بما في ذلك مفتاح الخدمة لديك في العنوان. يتم الحصول على كلتا القيمتين من ملف التكوين.
    - يتضمن الطلب بعض المعلمات، بما في ذلك المطالبة التي يجب أن تستند إلى الصورة، وعدد الصور المراد إنشاؤها، وحجم الصورة (الصور) التي يتم إنشاؤها.
    - تتضمن الاستجابة مطالبة منقحة قام نموذج DALL-E بالتوصل إليها من المطالبة المقدمة من المستخدم لجعلها أكثر وصفية، وعنوان URL للصورة التي تم إنشاؤها.
    
    > **هام**: إذا قمت بتسمية التوزيع الخاص بك بأي شيء آخر غير *dalle3* لموصى بها، فستحتاج إلى تحديث التعليمة البرمجية لاستخدام اسم عملية توزيعك.

### تشغيل التطبيق

الآن بعد أن راجعت التعليمات البرمجية، فقد حان الوقت لتشغيلها وإنشاء بعض الصور.

1. انقر بزر الماوس الأيمن فوق المجلد **CSharp** أو **Python** الذي يحتوي على ملفات التعليمات البرمجية الخاصة بك وافتح محطة طرفية متكاملة. ثم أدخل الأمر المناسب لتشغيل التطبيق لديك:

   **C#**
   ```
   dotnet run
   ```
   
   **Python**
   ```
   pip install requests
   python generate-image.py
   ```

3. عند المطالبة، أدخل وصفًا لصورة. على سبيل المثال، *زرافة تطيّر طائرة ورقية*.

4. انتظر حتى يتم إنشاء الصورة - سيتم عرض ارتباط تشعبي في جزء المحطة الطرفية. ثم حدد الارتباط التشعبي لفتح علامة تبويب جديدة للمستعرض وقم بمراجعة الصورة التي تم إنشاؤها.

   > **تلميح**: إذا لم يرجع التطبيق استجابة، فانتظر دقيقة وحاول مرة أخرى. قد تستغرق الموارد المنشورة حديثًا ما يصل إلى 5 دقائق لتصبح متاحة.

5. أغلق علامة تبويب المستعرض التي تحتوي على الصورة التي تم إنشاؤها وأعد تشغيل التطبيق لإنشاء صورة جديدة باستخدام مطالبة مختلفة.

## تنظيف

عند الانتهاء من مورد Azure OpenAI، تذكر حذف المورد بأكمله في **مدخل Microsoft Azure** في `https://portal.azure.com`.
